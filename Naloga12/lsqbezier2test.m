% Aproksimacija z Bezierjevo ploskvijo po metodi najmanjsih kvadratov:

N = 10;
[P1,P2,P3] = peaks(N);
P = [P1(:) P2(:) P3(:)];
m = 5;
n = 6;
[Bx,By,Bz] = lsqbezier2(m,n,P,(P(:,1)+3)/6,(P(:,2)+3)/6)

% Bx =
% 
%    -3.0000   -1.8000   -0.6000    0.6000    1.8000    3.0000
%    -3.0000   -1.8000   -0.6000    0.6000    1.8000    3.0000
%    -3.0000   -1.8000   -0.6000    0.6000    1.8000    3.0000
%    -3.0000   -1.8000   -0.6000    0.6000    1.8000    3.0000
%    -3.0000   -1.8000   -0.6000    0.6000    1.8000    3.0000
%    -3.0000   -1.8000   -0.6000    0.6000    1.8000    3.0000
%    -3.0000   -1.8000   -0.6000    0.6000    1.8000    3.0000
% 
% 
% By =
% 
%    -3.0000   -3.0000   -3.0000   -3.0000   -3.0000   -3.0000
%    -2.0000   -2.0000   -2.0000   -2.0000   -2.0000   -2.0000
%    -1.0000   -1.0000   -1.0000   -1.0000   -1.0000   -1.0000
%     0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000
%     1.0000    1.0000    1.0000    1.0000    1.0000    1.0000
%     2.0000    2.0000    2.0000    2.0000    2.0000    2.0000
%     3.0000    3.0000    3.0000    3.0000    3.0000    3.0000
% 
% 
% Bz =
% 
%     0.0014   -0.1726    0.7178   -0.6063    0.1722   -0.0032
%    -0.4631   20.0885  -71.7832   28.6051   -0.5596   -0.2634
%     0.2814  -45.7417  233.6590 -203.1805   43.4634   -0.5700
%    -0.2389   42.3229 -266.8682  229.4291  -32.2825    0.0088
%     0.4076  -23.4579  124.8366  -79.5015    2.5183    0.4331
%     0.3197   -5.2353   -6.3493   33.4768   -9.4134    0.2910
%     0.0016   -0.0211    0.0197    0.1308   -0.0667    0.0024

		
% Maksimalni absolutni razmik v z-koordinati:		

K = 50;
[x,y,z] = peaks(K);
u = linspace(0,1,K);
v = linspace(0,1,K);
[bx,by,bz] = bezier2(Bx,By,Bz,u,v);
norm(bz(:)-z(:),Inf)

% 4.0418